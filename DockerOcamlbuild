FROM ocaml/opam:ubuntu-22.04-ocaml-5.0

RUN set -ex; \
    eval $(opam env); \
    opam install -y \
    'ounit2=2.2.7' \
    'ocamlbuild=0.14.2' \
    'batteries=3.6.0' \
#     'core=v0.15.1' \
#     ''
    ;

USER opam
ENV USER=opam

RUN sudo mkdir -p /workspace; \
    sudo chown opam:opam /workspace
COPY workspace/cwtest.ml /workspace/cwtest.ml
COPY workspace/cwtest.mli /workspace/cwtest.mli
COPY workspace/_tags /workspace/_tags